
/////////////////////////////////
// Distinctive creature coloring
/////////////////////////////////


// Iron Golem

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~GOLIRO01~                                                             // Iron Golem
            ~GORGRD01~                                                             // Guardian (Iron) Golem (Watcher's Keep)
            ~GORGRD02~                                                             // Guardian (Iron) Golem (Watcher's Keep)
             ~KPGOL04~                                                             // Iron Golem (d'Arnise Keep)
              ~SHIRON~                                                             // Iron Golem (Shapechange spell)
              ~garsaph1~                                                           //who knows? Ask Miloch :P  (note: list pruned, we don't want to recolor Adamantine Golems)
              ~garsaph2~ 
              ~gholim~ 
              ~godgol1~ 
              ~godgol2~ 
              ~golkill2~ 
              ~golsaph1~ 
              ~golsaph2~ 
              ~golsaph3~ 
              ~ritgol0~ 
              ~ritgol1~ 
              ~ritgol2~ 
              ~giaearth~
              ~cbgorgrd~ 
              ~cbgorgre~ 
              ~gartopz1~ 
              ~gartopz2~ 
              ~godgol3~ 
              ~godgol4~ 
              ~godgol5~ 
              ~godgol6~ 
              ~godruby~ 
              ~golruby1~ 
              ~gorsta08~ 
              ~irontomb~ 
              ~kpgol07~ 
              ~tomegol4~ 
              ~yacasas~
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "-1261572608"                                                     // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "23"                                                              // major color (Light Copper)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Stone Golem

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~GOLSTO01~                                                           // Stone Golem
               ~DSTONE1~                                                           // Stone Golem (Rayic Gethras' home)
               ~KPGOL03~                                                           // Stone Golem (d'Arnise Keep)
               ~KPGOL05~                                                           // Stone Golem (d'Arnise Keep)
               ~STGOL01~                                                           // Stone Golem (Planar Prison)
              ~TOMEGOL3~                                                           // Stone Golem (Golem Manual)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "117900288"                                                       // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "5"                                                               // major color (Light Silver)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Flesh Golem

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~GOLFLE01~                                                           // Flesh Golem
               ~KPGOL01~                                                           // Flesh Golem (d'Arnise Keep)
               ~KPGOL06~                                                           // Flesh Golem (d'Arnise Keep)
              ~TOMEGOL1~                                                           // Flesh Golem (Golem Manual)
                ~XGOLEM~                                                           // Flesh Golem (Xzar's quest)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "84215808"                                                        // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "4"                                                               // major color (Auburn)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Sand Golem

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~GOLSAN01~                                                           // Sand Golem
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "67569408"                                                        // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "37"                                                              // major color (Dark Dirty Yellow)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Juggernaut Golem

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~GOLJUG01~                                                           // Juggernaut Golem
              ~JUGJUG01~                                                           // Juggernaut Golem (Jermien's quest, Umar Hills)
              ~JUGJUG02~                                                           // Juggernaut Golem (Jermien's quest, Umar Hills)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "201984000"                                                       // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "10"                                                              // major color (Light Pure Gold)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Ice Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPICE01~                                                           // Ice Mephit
              ~MEPICE02~                                                           // Ice Mephit
              ~OBSICE02~                                                           // Ice Mephit
               ~RR#MICE~                                                           // Ice Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "420087552"                                                       // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "71"                                                              // major color (Frost Blue)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Radiant Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPRAD01~                                                           // Radiant Mephit
              ~MEPRAD02~                                                           // Radiant Mephit
               ~RR#MRAD~                                                           // Radiant Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "168299008"                                                       // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "74"                                                              // major color (Solid White)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Fire Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPFIR01~                                                           // Fire Mephit
              ~ELEMEP04~                                                           // Fire Mephit
              ~OBSFIR02~                                                           // Fire Mephit
               ~RR#MFIR~                                                           // Fire Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "529408"                                                          // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "67"                                                              // major color (Shiny Gold)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Lightning Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPLIG01~                                                           // Lightning Mephit
               ~RR#MLIG~                                                           // Lightning Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "67174656"                                                        // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "60"                                                              // major color (Dark Purple)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Mineral Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPMIN01~                                                           // Mineral Mephit
              ~ELEMEP07~                                                           // Mineral Mephit
               ~RR#MMIN~                                                           // Mineral Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "67305984"                                                        // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "27"                                                              // major color (Gray)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Magma Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPMAG01~                                                           // Magma Mephit
              ~MEPMAG02~                                                           // Magma Mephit
              ~ELEMEP05~                                                           // Magma Mephit
              ~OBSFIR03~                                                           // Magma Mephit
               ~RR#MMAG~                                                           // Magma Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "577106432"                                                       // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "46"                                                              // major color (Red)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Mist Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPMIS01~                                                           // Mist Mephit
               ~AR18FAM~                                                           // Mist Mephit
                ~GPFAM1~                                                           // Pitch
               ~RR#MMST~                                                           // Mist Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "16973824"                                                        // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "32"                                                              // major color (Dark Sea Green)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Steam Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPSTE01~                                                           // Steam Mephit
              ~ELEMEP02~                                                           // Steam Mephit
               ~RR#MSTE~                                                           // Steam Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "33555456"                                                        // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "61"                                                              // major color (Lavender)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Air Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPAIR01~                                                           // Air Mephit
               ~RR#MAIR~                                                           // Air Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "84215040"                                                        // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "63"                                                              // major color (Light Gray)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Salt Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPSAL01~                                                           // Salt Mephit
              ~ELEMEP03~                                                           // Salt Mephit
               ~RR#MSAL~                                                           // Salt Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "168232448"                                                       // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "79"                                                              // major color (Light Silver)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Dust Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPDUS01~                                                           // Dust Mephit
              ~ELEMEP08~                                                           // Dust Mephit
                ~MDDUST~                                                           // Dust Mephit
               ~RR#MDUS~                                                           // Dust Mephit (gated)
              ~TCMMBKWM~                                                           // Book Mephit (Classic Adventures)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "1684300800"                                                      // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "66"                                                              // major color (Faded Black)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Ooze Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPOOZ01~                                                           // Ooze Mephit
              ~ELEMEP01~                                                           // Ooze Mephit
               ~RR#MOOZ~                                                           // Ooze Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "16711680"                                                        // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "69"                                                              // major color (Shiny Green)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Earth Mephit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MEPEAR01~                                                           // Earth Mephit
              ~ELEMEP06~                                                           // Earth Mephit
               ~RR#MEAR~                                                           // Earth Mephit (gated)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "322527232"                                                       // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "41"                                                              // major color (Dark Brown)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Quasit

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~FAMQUAS~                                                            // Quasit (familiar SoA)
             ~FAMQUA25~                                                            // Quasit (familiar ToB)
             ~DEADDEM2~                                                            // Quasit
              ~DQUAS01~                                                            // Quasit
              ~GORTAN5~                                                            // Quasit
             ~IMPQUA01~                                                            // Quasit
              ~TELQUA1~                                                            // Quasit
              ~TELQUA2~                                                            // Quasit
                ~TCJOT~                                                            // Jot the Quasit (Classic Adventures)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "459520"                                                          // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "52"                                                              // major color (light green)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Imp

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~FAMIMP~                                                             // Imp (familiar SoA)
            ~FAMIMP25~                                                             // Imp (familiar ToB)
              ~DIMP01~                                                             // Imp
              ~FSRIDD~                                                             // Imp
             ~GORBAT4~                                                             // Imp
            ~GORIMP01~                                                             // Imp
               ~IMP01~                                                             // Imp
            ~MEKIMP01~                                                             // Imp
             ~RUMAR03~                                                             // Imp
            ~SAHIMP01~                                                             // Imp
            ~SAHIMP02~                                                             // Imp
             ~TELIMP1~                                                             // Imp
               ~UDIMP~                                                             // Imp
            ~SEVPAT03~                                                             // Pooky
            ~x#dyqimp~                                                             // Ichthraa, the imp in Dynaheir's quest (BG1 NPCs)
             ~TCIMP01~                                                             // Imp (Classic Adventures)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "65280"                                                           // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "47"                                                              // major color (dark red)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Giant Troll

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~TROLGI01~                                                           // Giant Troll
              ~TROLGI02~                                                           // Giant Troll
              ~TROLLENS~                                                           // Giant Troll
              ~CHALTROL~                                                           // Giant Troll
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "7925760"                                                         // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "40"                                                              // major color (Dark Dirty Copper)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Snow Troll

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~OBSICE01~                                                           // Snow Troll
              ~dw#trlbl~ 
              ~dw#trlsn~
              ~obsice11~ 
              ~trolic03~ 
              ~trolic04~ 
              ~trolsn01~ 
              ~trolsn02~
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "285540352"                                                       // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "68"                                                              // major color (Shiny Blue)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Ice Troll

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~trolic01~                                                           // Ice Troll
              ~trolic02~                                                           // Ice Troll
              ~kptrol06~                                                           // Ice Troll
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "66" END                                                // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "419561472"                                                       // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (transparency fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "50"                                                              // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "58"                                                              // major color (Dark Blue)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Desert Troll

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~trolde01~                                                           // Desert Troll
              ~trolde02~
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "16909824"                                                        // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (transparency fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "50"                                                              // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "67"                                                              // major color (Shiny Gold)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Greater Mummy

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~MUMGRE01~                                                           // Greater Mummy
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "16909568"                                                        // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
WRITE_BYTE  0x2E "67"                                                              // major color (Shiny Gold)
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Nishruu

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~NISHRUSU~                                                           // Nishruu
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "51" END                                                // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                          // delete the EFF with the designated opcode (remove any existent tint)
INT_VAR opcode_to_delete = "52" END                                                // mark opcode #52 (Colour: Very Bright by RGB) for deletion
SET opcode = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
SET target = "1"                                                                   // target: 1 (self)
SET timing = "9"                                                                   // timing mode: 9 (permanent after death)
SET parameter1 = "64000"                                                           // param1: (color designation)
SET parameter2 = "2"                                                               // param2: 2 (location - major color)
SET parameter3 = "0"                                                               // param3: 0
SET parameter4 = "0"                                                               // param4: 0
SET power = "0"                                                                    // power: 0
SET resist_dispel = "0"                                                            // dispel/resistance: 0 (non-magical)
SET duration = "0"                                                                 // duration: 0
SET probability1 = "100"                                                           // probability1: 100%
SET probability2 = "0"                                                             // probability2: 0%
SET dicenumber = "0"                                                               // dicenumber: 0
SET dicesize = "0"                                                                 // dicesize: 0
SET savingthrow = "0"                                                              // saving throw type: 0 (none)
SET savebonus = "0"                                                                // save bonus: 0
SET school = "0"                                                                   // school: 0 (schoolless)
SET lowestafflvl = "0"                                                             // lowest level affected: 0
SET highestafflvl = "0"                                                            // highest level affected: 0
SET casterx = "0"                                                                  // casterx: 0
SET castery = "0"                                                                  // castery: 0
SET targetx = "0"                                                                  // targetx: 0
SET targety = "0"                                                                  // targety: 0
SET casterlvl  = "0"                                                               // caster level: 0
SET sectype = "0"                                                                  // secondary type: 0
SPRINT ~resource~ ~~                                                               // resref: none
SPRINT ~resource2~ ~~                                                              // resref2: none
SPRINT ~resource3~ ~~                                                              // resref3: none
SPRINT ~vvcresource~ ~~                                                            // vvcresref: none
SPRINT ~effsource~ ~~                                                              // effsource: none
SPRINT ~effvar~ ~~                                                                 // effvar: none
LAUNCH_PATCH_MACRO ~ADD_CRE_EFFECT~                                                // add new creature effect
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_BYTE  0x2E "46"                                                              // major color (red)
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Nabassu

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~DEMNAB01~                                                           // Nabassu
              ~DEMNAB02~                                                           // Nabassu
              ~DEMNABSU~                                                           // Nabassu (summoned)
              ~ENDDEM04~                                                           // Nabassu
              ~ENDDEM05~                                                           // Nabassu
              ~OBSDEM05~                                                           // Nabassu
               ~PPNAB01~                                                           // Nabassu
               ~PPNAB02~                                                           // Nabassu
               ~PPNAB03~                                                           // Nabassu
               ~PMASTER~                                                           // Master of Thralls (named Nabassu within the Planar Prison)
               ~RUMAR02~                                                           // Nabassu
                ~UDNABA~                                                           // Nabassu
              ~TANARI01~                                                           // Tanar'ri (Nabassu within the Planar Sphere)
                 ~TANAR~                                                           // Aec'Letec (BGT)
                ~_TANAR~                                                           // Aec'Letec (Tutu)
              ~barbe2~ 
              ~barbe3~ 
              ~caddem13~ 
              ~caddem5~
              ~demnabr1~ 
              ~demnabr2~
              ~enddem04~ 
              ~enddem05~ 
              ~esp04~ 
              ~f_demdrg~ 
              ~finnabas~
              ~rumar02~ 
              ~tg#dem2~ 
              ~z#gnab01~ 
              ~z#gnabas~
              fl#nabsu                                                             //aTweaks fiend intended for SCSII
              fl#hsnab                                                             //Fiendish Gating  
              rr#hsnab                                                             //Fiendish Gating  
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
  WRITE_SHORT 0x28 "4352"                                                          // Sets avatar to TANARRI (winged demon)
  WRITE_BYTE  0x2E "34"                                                            // major color (Light Green/Dark Blue)
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "-168490496"                                                      // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


//  Special case for the SR/SCS Death Knight. We don't want to make him look like a Nabassu.

ACTION_IF FILE_EXISTS_IN_GAME ~dw#nabsu.cre~ BEGIN                                 // if the file exists
COPY_EXISTING ~dw#nabsu.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
PATCH_IF NOT FILE_CONTAINS_EVALUATED (~%SOURCE_FILE%~ ~DVDEATHK~) BEGIN            // don't alter avatar or coloring if this is SR's Death Knight
// =============================================================================== // the actual work starts from here
  WRITE_SHORT 0x28 "4352"                                                          // Sets avatar to TANARRI (winged demon)
  WRITE_BYTE  0x2E "34"                                                            // major color (Light Green/Dark Blue)
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "-168490496"                                                      // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
// =============================================================================== // the actual work ends here
END                                                                                // ends PATCH_IF block
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block




// Pit Fiend

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
                ~DEMPIT~                                                           // Pit Fiend
              ~DEMPIT01~                                                           // Pit Fiend
              ~DEMPITSU~                                                           // Pit Fiend (summoned)
               ~TELPIT1~                                                           // Pit Fiend
               ~TELPIT2~                                                           // Pit Fiend
               ~GORBAT1~                                                           // Ka'rashur (Watcher's Keep Baatezu leader)
               ~caddem11~ 
               ~caddem18~ 
               ~caddem25~ 
               ~caddem3~
               ~dempitr1~ 
               ~dempitr2~
               ~dubnd11~
               ~dw#bazpf~
               ~dw#pitsu~ 
               ~heldem3~ 
               ~heldem4~ 
               ~heldem5~ 
               ~psbaatl~ 
               ~rempitsu~ 
               ~tg#dem1~ 
               ~z#gpit01~ 
               ~z#gpitfd~ 
               ~z_whel1~ 
               ~z_whel2~ 
               ~z_whel3~ 
               ~z_whel4~
               fl#pitsu                                                            //aTweaks fiend intended for SCSII
               fl#hspit                                                            //Fiendish Gating 
               rr#hspit                                                            //Fiendish Gating 
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
  WRITE_SHORT 0x28 "4352"                                                          // Sets avatar to TANARRI (winged demon)
  WRITE_BYTE  0x2E "47"                                                            // major color (dark red)
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "61440"                                                           // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Balor

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
               ~BALOR01~                                                           // Balor
              ~DEMBAL01~                                                           // Balor
              ~DEMBAL02~                                                           // Balor
              ~DEMOSUM2~                                                           // Balor
              ~ENDDEM03~                                                           // Balor
                ~GORDEM~                                                           // Balor (mismatched animation fixed)
              ~GORDEMC1~                                                           // Balor
              ~JONDEM02~                                                           // Balor (mismatched animation fixed)
              ~JONDEM04~                                                           // Balor (mismatched animation fixed)
              ~M05DEMON~                                                           // Balor
              ~MELSUM04~                                                           // Balor
               ~SUDEMON~                                                           // Balor
              ~SUDEMON2~                                                           // Balor
              ~SUDEMDE1~                                                           // Balor
              ~SUDEMDE2~                                                           // Balor
               ~SUDEMW1~                                                           // Balor
               ~TELBAL1~                                                           // Balor
               ~TELBAL2~                                                           // Balor
               ~UDBALOR~                                                           // Balor
               ~GORTAN1~                                                           // Tahazzar (Watcher's Keep Tanar'ri leader)
               ~acq50002~ 
               ~actanar~ 
               ~asham~ 
               ~balorsu~ 
               ~bw05jere~ 
               ~caddem1~ 
               ~caddem12~ 
               ~caddem16~ 
               ~caddem17~ 
               ~caddem18~ 
               ~caddem21~ 
               ~caddem24~ 
               ~caddem25~ 
               ~caddem4~ 
               ~caddem8~ 
               ~caddem9~ 
               ~cbmalrdm~ 
               ~cbtanasu~ 
               ~cratzyl~ 
               ~decre#09~ 
               ~delord~ 
               ~dembalr1~ 
               ~dembalsu~ 
               ~dpdem01~ 
               ~dsroach~ 
               ~dubnd10~ 
               ~dw#grbal~ 
               ~eastdem2~ 
               ~eastdem4~ 
               ~eastdem7~ 
               ~eastdem9~ 
               ~endragor~ 
               ~errtu~ 
               ~errtu01~ 
               ~errtu02~ 
               ~errtu03~ 
               ~f_demdrg~ 
               ~f_errtu~ 
               ~f_tanari~ 
               ~f_tansum~ 
               ~finbalor~ 
               ~garg~ 
               ~glourkis~ 
               ~godmari4~ 
               ~gordemc1~
               ~heldem5~ 
               ~hellfear~ 
               ~hellgree~ 
               ~hellprid~ 
               ~hellself~ 
               ~holytana~ 
               ~jc_dem02~ 
               ~m#ydemon~ 
               ~ntdemon~ 
               ~orcus~ 
               ~ppdemon~ 
               ~psdem01~ 
               ~psdem02~ 
               ~psdem03~ 
               ~pstana01~ 
               ~pstanal~ 
               ~r#demon~ 
               ~riattan1~ 
               ~riattan2~ 
               ~riattan3~ 
               ~rr#sbalr~ 
               ~sudemde1~ 
               ~sumtan01~ 
               ~sumtan02~ 
               ~tanarix1~ 
               ~tanarixa~ 
               ~tanarixb~ 
               ~tannar~ 
               ~tannar2~ 
               ~tannar3~ 
               ~tartar01~ 
               ~tartarus~ 
               ~tg#did3~ 
               ~tg#did4~ 
               ~va#balor~ 
               ~w_rune~ 
               ~yoshimoa~ 
               ~z#gbalor~ 
               ~z_2balor~ 
               ~z_bered~ 
               ~z_torta~ 
               ~zy18bala~ 
               ~zy18balb~ 
               ~zy18balc~ 
               ~zy18bald~ 
               ~zy18bale~ 
               ~zy18balf~ 
               ~zy18balg~ 
               ~zy18balh~ 
               ~zy18bali~ 
               ~zy18balj~ 
               ~zy18balk~ 
               ~zy18ball~ 
               ~zy18balm~
               fl#balsu                                                            //aTweaks fiend intended for SCSII
               fl#hsbal                                                            //Fiendish Gating     
               rr#hsbal                                                            //Fiendish Gating     
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
  WRITE_SHORT 0x28 "4352"                                                          // Sets avatar to TANARRI (winged demon)
  WRITE_BYTE  0x2E "35"                                                            // major color (orange)
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "16909824"                                                        // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block



// Maurezhi

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
             ~DEMMAU01~                                                            // Maurezhi
              ~GORTAN6~                                                            // Maurezhi
             ~OBSDEM04~                                                            // Maurezhi
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
  WRITE_BYTE  0x2E "20"                                                            // major color (dark moldy green)
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "-1765239296"                                                     // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Bone Fiend

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~DBONEF01~                                                           // Bone Fiend
               ~GORBAT5~                                                           // Bone Fiend
              ~MELSUM02~                                                           // Bone Fiend
              ~dw#vibon~
              fl#hsbfn                                                             //Fiendish Gating
              rr#hsbfn                                                             //Fiendish Gating
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
  WRITE_BYTE  0x2E "36"                                                            // major color (light dirty yellow)
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "2112284160"                                                      // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Abishai (Red)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~ABISRED1~                                                           // Abishai
              ~DEMABI01~                                                           // Abishai
              ~abishai1~ 
              ~godabis1~ 
              ~godabis2~ 
              ~nsabish~ 
              ~psbaat02~
              ~psbaat2a~ 
              ~rabi~ 
              ~redabi01~ 
              ~remorle~
              fl#hsabi                                                             //Fiendish Gating
              rr#hsabi                                                             //Fiendish Gating
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
  WRITE_BYTE  0x2E "46"                                                            // major color (red)
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "61440"                                                           // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Hellcat

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~GORCAMB6~                                                           // Hellcat
              ~GORCAMB7~                                                           // Hellcat
               ~HGFEL01~                                                           // Hellcat
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
PATCH_INCLUDE ~aTweaks/lib/fj_cre_validity.tpp~                                    // Nythrun's CRE validity macro (detects corrupt and invalid CREs)
PATCH_IF valid BEGIN
  PATCH_INCLUDE ~aTweaks/lib/fj_cre_reindex.tpp~                                   // Nythrun's CRE reindex macro (this also calls the EFF macro if needed)
// =============================================================================== // the actual work starts from here
WRITE_BYTE  0x2E "5"                                                               // major color (light silver)
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "1684300800"                                                      // param1: (color designation)
  "parameter2" = "2"                                                               // param2: 2 (location - major color)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "65"                                                                  // effect: #65 (Blur)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "0"                                                               // param1: 0
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
  LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                           // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (Transparency Fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "240"                                                             // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
  END                                                                              // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
// =============================================================================== // the actual work ends here
END                                                                                // ends file validity check
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Special transparency and coloring effects for the Emphatic Manifestation in the Unseeing Eye quest

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~RIFTCR04~                                                           // Emphatic Manifestation
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "8"                                                                   // effect: #8 (Colour: Change by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "64000"                                                           // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "65"                                                                  // effect: #65 (blur)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "0"                                                               // param1: 0
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (transparency fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "240"                                                             // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
WRITE_SHORT 0x28 "4352"                                                            // Sets avatar to TANARRI (winged demon)
WRITE_BYTE  0x2E "47"                                                              // major color (dark red)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Dryad

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~DRYAD~                                                              // Dryad of the Cloudpeaks (BGT)
              ~_DRYAD~                                                             // Dryad of the Cloudpeaks (Tutu)
              ~DRY01~                                                              // Dryad (unused?)
              ~DRYAD01~                                                            // Dryad (unused?)
              ~DRYAD02~                                                            // Dryad (unused?)
              ~DRYAD03~                                                            // Dryad (unused?)
              ~IDRYAD02~                                                           // Cania (one of Irenicus captive Dryads)
              ~rr#sdrya~                                                           // aTweaks' summoned Dryad
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_BYTE 0x2C 15                                                               // metal color (Pastel Green)
  WRITE_BYTE 0x2D 54                                                               // minor color (Dark Green)
  WRITE_BYTE 0x2E 69                                                               // major color (Shiny Green)
  WRITE_BYTE 0x2F 26                                                               // skin color (Wood)
  WRITE_BYTE 0x30 32                                                               // leather color (Dark Sea Green)
  WRITE_BYTE 0x31 20                                                               // armor color (Dark Moldy Green)
  WRITE_BYTE 0x32 67                                                               // hair color (Shiny Gold)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Hamadryad

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~VAELASA~                                                            // Vaelasa (Fairy Queen in Windsper Hills)
              ~DRYADHA~                                                            // Hamadryad (BGT)
              ~_DRYADHA~                                                           // Hamadryad (Tutu)
              ~HAMASU~                                                             // deault summoned Hamadryad (unused?)
              ~rr#shama~                                                           // aTweaks' summoned Hamadryad
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_BYTE 0x2C 36                                                               // metal color (Light Dirty Yellow)
  WRITE_BYTE 0x2D 7                                                                // minor color (Light Metallic Green)
  WRITE_BYTE 0x2E 103                                                              // major color (Pine Green)
  WRITE_BYTE 0x2F 16                                                               // skin color (Silverish Gold)
  WRITE_BYTE 0x30 20                                                               // leather color (Dark Moldy Green)
  WRITE_BYTE 0x31 15                                                               // armor color (Pastel Green)
  WRITE_BYTE 0x32 53                                                               // hair color (Green)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Nymph

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~HGNYMPH~                                                            // Nymph
              ~NYMPHSU~                                                            // default summoned Nymph
              ~ABELA~                                                              // Abela the Nymph (BGT)
              ~_ABELA~                                                             // Abela the Nymph (Tutu)
              ~rr#snymp~                                                           // aTweaks' summoned Nymph
              ~dvnymph~                                                            // Spell Revisions' summoned Nymph
             ~dw#nymsu~                                                            // SCSII summoned Nymph
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_BYTE 0x2C 115                                                              // metal color (Sunkissed)
  WRITE_BYTE 0x2D 85                                                               // minor color (21 Carat Gold)
  WRITE_BYTE 0x2E 67                                                               // major color (Shiny Gold)
  WRITE_BYTE 0x2F 11                                                               // skin color (Light Rose Red)
  WRITE_BYTE 0x30 115                                                              // leather color (Sunkissed)
  WRITE_BYTE 0x31 115                                                              // armor color (Sunkissed)
  WRITE_BYTE 0x32 4                                                                // hair color (Auburn)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Sirine

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
                ~SIRINE~                                                           // Sirine (BGT)
               ~_SIRINE~                                                           // Sirine (Tutu)
              ~SIRINE_A~                                                           // Sirine (BGT)
              ~_IRINE_A~                                                           // Sirine (Tutu)
              ~SIRINE_B~                                                           // Sirine (BGT)
              ~_IRINE_B~                                                           // Sirine (Tutu)
              ~SIRINE01~                                                           // Sirine
              ~SIRINE02~                                                           // Sirine (BGT)
              ~_IRINE02~                                                           // Sirine (Tutu)
                   ~SIL~                                                           // Sil (BGT)
                  ~_SIL~                                                           // Sil (Tutu)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_BYTE 0x2C 25                                                               // metal color (Dark Pure Gold)
  WRITE_BYTE 0x2D 31                                                               // minor color (Light Sea Blue)
  WRITE_BYTE 0x2E 56                                                               // major color (Dark Turquoise)
  WRITE_BYTE 0x2F 15                                                               // skin color (Pastel Green)
  WRITE_BYTE 0x30 14                                                               // leather color (Dark Pure Silver)
  WRITE_BYTE 0x31 20                                                               // armor color (Dark Moldy Green)
  WRITE_BYTE 0x32 5                                                                // hair color (Light Silver)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Nereid

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~SHOAL~                                                              // Shoal the Nereid (BGT)
              ~_SHOAL~                                                             // Shoal the Nereid (Tutu)
            ~rr#enere~                                                             // aTweaks' Nereid
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_BYTE 0x2C 25                                                               // metal color (Dark Pure Gold)
  WRITE_BYTE 0x2D 32                                                               // minor color (Dark Sea Green)
  WRITE_BYTE 0x2E 58                                                               // major color (Dark Blue)
  WRITE_BYTE 0x2F 97                                                               // skin color (Light Minty Blue)
  WRITE_BYTE 0x30 14                                                               // leather color (Dark Pure Silver)
  WRITE_BYTE 0x31 20                                                               // armor color (Dark Moldy Green)
  WRITE_BYTE 0x32 16                                                               // hair color (Silverish Gold)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Succubus

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~DEMSUC01~                                                           // Succubus
              ~GORSUC01~                                                           // Succubus
               ~GORTAN2~                                                           // Succubus
              ~GORWOM01~                                                           // Nalmissra
                ~KIRINH~                                                           // Kirinhale, the Succubus in Durlag's Tower (BGT)
               ~_KIRINH~                                                           // Kirinhale, the Succubus in Durlag's Tower (Tutu)
              ~RR#HSSUC~                                                           // aTweaks Succubus (Fiendish Gating)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_BYTE 0x2C 47                                                               // metal color (Pure Dark Red)
  WRITE_BYTE 0x2D 47                                                               // minor color (Pure Dark Red)
  WRITE_BYTE 0x2E 101                                                              // major color (Light Metallic Red)
  WRITE_BYTE 0x2F 12                                                               // skin color (Light Carnation Pink)
  WRITE_BYTE 0x30 19                                                               // leather color (Dark Rose Red)
  WRITE_BYTE 0x31 19                                                               // armor color (Dark Rose Red)
  WRITE_BYTE 0x32 47                                                               // hair color (Pure Dark Red)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Aerial Servant

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~SERVSU~                                                             // Aerial Servant
            ~rr#easer~                                                             // Aerial Servant (aTweaks)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "8"                                                                   // effect: #8 (Colour: Change by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "-1778384896"                                                     // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (transparency fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "100"                                                             // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 17                                                               // major color (Light Blue)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Air Elemental (8 and 12 HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
             ~ELAIR01~                                                             // Air Elemental (12 HD)
            ~ELAIRL01~                                                             // Lesser Air Elemental (8 HD)
            ~ELAIRSU1~                                                             // Lesser Air Elemental (8 HD, summoned, wizard version)
            ~ELAIRSUW~                                                             // Air Elemental (12 HD, summoned, wizard version)
            ~ELARIL01~                                                             // Lesser Air Elemental (8 HD, Bioware's typo?)
            ~GORAIR01~                                                             // Lesser Air Elemental (8 HD, Watcher's Keep)
               ~MDAIR~                                                             // Air Elemental (12 HD, unused?)
              ~MDAIR2~                                                             // Air Elemental (12 HD, unused?)
            ~PAIREL01~                                                             // Air Elemental (12 HD, unused?)
            ~SUMELAIR~                                                             // Lesser Air Elemental (8 HD, summoned, Staff of Air)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_BYTE 0x2E 6                                                                // major color (Dark Silver)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Air Elemental (16 HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~ELAIRG01~                                                             // Greater Air Elemental (16 HD)
            ~ELAIRSU2~                                                             // Air Elemental (16 HD, wizard version)
            ~GORAIR02~                                                             // Greater Air Elemental (16 HD, Watcher's Keep)
              ~MDAIRG~                                                             // Greater Air Elemental (16 HD, unused?)
             ~MDAIRG2~                                                             // Greater Air Elemental (16 HD, unused?)
              ~MDHSSS~                                                             // Greater Air Elemental (16 HD, unused?)
              ~MDHSSS~                                                             // Greater Air Elemental (16 HD, unused?)
            ~SWAAIR01~                                                             // Air Elemental (16 HD, Elemental Summoning HLA)
               ~UDAIR~                                                             // Air Elemental (Underdark portal)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "33686016"                                                        // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 5                                                                // major color (Light Silver)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Air Elemental (20+ HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~ELAIRSU3~                                                             // Air Elemental (20+ HD, summoned, wizard version)
               ~SUAIR~                                                             // Air Elemental (Suldanesselar, Tree of Life guardian)
            ~SWAAIR02~                                                             // Air Elemental (20+ HD, summoned, Elemental Summoning HLA)
              ~UDELDA~                                                             // Air Elemental (Underdark portal guardian)
            ~elemyanc~                                                             // Yan-C-Bin
            ~finsol02~                                                             // Yan-C-Bin in ToB
            ~elemchan~                                                             // Chan
            ~rr#eaire~                                                             // Elder Air Elemental (aTweaks)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "84215040"                                                        // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (transparency fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "85"                                                              // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 74                                                               // major color (Solid White)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Earth Elemental (8 and 12 HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
             ~ELEAR01~                                                             // Earth Elemental (12 HD)
            ~ELEARL01~                                                             // Lesser Earth Elemental (8 HD)
             ~ELEARPR~                                                             // Earth Elemental (12 HD, summoned, priest version)
            ~ELEARSU1~                                                             // Earth Elemental (8 HD, summoned, wizard version)
            ~ELEARSU2~                                                             // Earth Elemental (12 HD, summoned, wizard version)
            ~ELEARSUW~                                                             // Lesser Earth Elemental (8 HD, summoned, wizard version)
            ~ELEEEL01~                                                             // Lesser Earth Elemental (8 HD)
              ~KEARTH~                                                             // Earth Elemental (12 HD, unused?)
            ~MEKEAR01~                                                             // Lesser Earth Elemental (8 HD, Mekrath's quest)
             ~SHEARTH~                                                             // Earth Elemental (12 HD, Shapechange Spell)
            ~SUMELEAR~                                                             // Lesser Earth Elemental (8 HD, summoned, Staff of Earth)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_BYTE 0x2E 8                                                                // major color (Dark Muddish Brown)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Earth Elemental (16 HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~ELEARG01~                                                             // Greater Earth Elemental (16 HD)
            ~ELEARPR2~                                                             // Earth Elemental (16 HD, summoned, priest version)
             ~ELEARSU~                                                             // Earth Elemental (16 HD, summoned, unused?)
            ~ELEARSU3~                                                             // Earth Elemental (16 HD, summoned, wizard version)
            ~SWAEAR01~                                                             // Earth Elemental (16 HD, summoned, Elemental Summoning HLA)
             ~UDEARTH~                                                             // Earth Elemental (Underdark portal spawn)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "16909312"                                                        // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 9                                                                // major color (Light Muddish Brown)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Earth Elemental (20+ HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~DRUEAR01~                                                             // Earth Elemental (Druid Earth Elemental Transformation HLA)
            ~ELEARPR3~                                                             // Earth Elemental (20+ HD, priest version)
            ~ELEARSU4~                                                             // Earth Elemental (20+ HD, wizard version)
             ~MDEARTH~                                                             // Earth Elemental (20+ HD, unused?)
            ~MDEARTH2~                                                             // Earth Elemental (20+ HD, unused?)
             ~SUEARTH~                                                             // Earth Elemental (Suldanesselar, Tree of Life guardian)
            ~SWAEAR02~                                                             // Earth Elemental (20+ HD, Elemental Summoning HLA)
              ~UDELDE~                                                             // Earth Elemental (Underdark portal guardian)
            ~rr#eeare~                                                             // Elder Earth Elemental (aTweaks)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "50726912"                                                        // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 49                                                               // major color (Dark Bronze)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Sunnis

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~elemsunn~                                                             // Sunnis
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "65280"                                                           // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 49                                                               // major color (Dark Bronze)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block

// Ogremoch

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~elemogre~                                                             // Ogremoch
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "-16720896"                                                       // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 94                                                               // major color (Rhubarb)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Fire Elemental (8 HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~ELEFEL01~                                                             // Lesser Fire Elemental (8 HD)
            ~ELFIRL01~                                                             // Lesser Fire Elemental (8 HD)
            ~ELFIRSU1~                                                             // Fire Elemental (8 HD, summoned, wizard version)
            ~ELFIRSUW~                                                             // Lesser Fire Elemental (8 HD, summoned, wizard version)
            ~SUMELFIR~                                                             // Lesser Fire Elemental (8 HD, summoned, Staff of Fire)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "51"                                                                  // effect: #51 (Colour: Strong/Dark by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "9566720"                                                         // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 4                                                                // major color (Auburn)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Fire Elemental (12 HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~C6DROWGO~                                                             // Fire Elemental (12 HD, Underdark Exit)
            ~DDGUARD7~                                                             // Guardian (Tomb of King Strohm III)
               ~ELFIR~                                                             // Fire Elemental (12 HD)
             ~ELFIR01~                                                             // Fire Elemental (12 HD)
             ~ELFIRPR~                                                             // Fire Elemental (12 HD, summoned, priest version)
            ~ELFIRSU2~                                                             // Fire Elemental (12 HD, summoned, wizard version)
              ~SHFIRE~                                                             // Fire Elemental (12 HD, Shapechange Spell)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_BYTE 0x2E 67                                                               // major color (Shiny Gold)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Fire Elemental (16 HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~DECKFELE~                                                             // Fire Elemental (Deck of Many Things)
            ~ELFIRG01~                                                             // Fire Elemental (16 HD)
            ~ELFIRPR2~                                                             // Fire Elemental (16 HD, summoned, priest version)
            ~ELFIRSU~                                                              // Fire Elemental (16 HD, summoned, unused?)
            ~ELFIRSU3~                                                             // Fire Elemental (16 HD, summoned, wizard version)
            ~GORFIR01~                                                             // Greater Fire Elemental (16 HD, Watcher's Keep)
            ~GORFIR02~                                                             // Greater Fire Elemental (16 HD, Watcher's Keep)
            ~GORFIR03~                                                             // Greater Fire Elemental (16 HD, Watcher's Keep)
            ~GORFIR04~                                                             // Greater Fire Elemental (16 HD, Watcher's Keep)
            ~OBSFIR06~                                                             // Greater Fire Elemental (16 HD, Planar Sphere)
            ~SUELEW1~                                                              // Greater Fire Elemental (16 HD, summoned, unused?)
            ~SUELEW2~                                                              // Greater Fire Elemental (16 HD, summoned, unused?)
            ~SWAFIR01~                                                             // Fire Elemental (16 HD, summoned, Elemental Summoning HLA)
            ~TELELFIR~                                                             // Greater Fire Elemental (16 HD, Watcher's Keep)
            ~YSCARA04~                                                             // Greater Fire Elemental (16 HD, unused?)
              ~UDFIRE~                                                             // Fire Elemental (Underdark portal spawn)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "197376"                                                          // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 24                                                               // major color (Dark Gold)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Fire Elemental (20+ HD)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~DRUFIR01~                                                             // Fire Elemental (Druid Fire Elemental Transformation HLA)
            ~ELFIRPR3~                                                             // Fire Elemental (20+ HD, summoned, priest version)
            ~ELFIRSU4~                                                             // Fire Elemental (20+ HD, summoned, wizard version)
             ~SUFIRE~                                                              // Fire Elemental (Suldanesselar, Tree of Life guardian)
            ~SWAFIR02~                                                             // Fire Elemental (20+ HD, summoned, Elemental Summoning HLA)
              ~UDELDF~                                                             // Fire Elemental (Underdark, portal guardian)
            ~rr#efire~                                                             // Elder Fire Elemental (aTweaks)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "394752"                                                          // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 50                                                               // major color (Dark Yellow)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block

// Fire Elemental Princes (Imix and Zaaman Rul)

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~elemimix~                                                             // Imix
            ~elemzaam~                                                             // Zaaman Rul
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  WRITE_SHORT 0x28 "29460"                                                         // Sets avatar to BURNING_MAN
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
  WRITE_BYTE 0x2E 25                                                               // major color (Dark Pure Gold)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Water Weird

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
              ~rr#ewwei~                                                           // aTweaks' Water Weird
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (transparency fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "125"                                                             // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
  WRITE_BYTE 0x2E 31                                                               // major color (Light Sea Blue)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Greater Water Elemental

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~ELWATG01~                                                             // Greater Water Elemental
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "50397184"                                                        // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (transparency fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "75"                                                              // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 57                                                               // major color (Light Blue)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Fire Salamander

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
             ~hgsal01~                                                             // Fire Salamander
            ~icsalfir~                                                             // Fire Salamander (Planar Sphere)
            ~wrmons01~                                                             // Fire Salamander (Hell Wrath, possibly unused?)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
  WRITE_BYTE 0x2E 49                                                               // major color (Dark Bronze)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Frost Salamander

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~salgrice~                                                             // Frost Salamander (Abazigal's Lair)
            ~icsalcol~                                                             // Ice Salamander (Planar Sphere)
            ~telicesa~                                                             // Ice Salamander (unused?)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  WRITE_BYTE 0x2E 58                                                               // major color (Dark Blue)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Salamander Noble

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~SALGRFIR~                                                             // Salamander Noble
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "394752"                                                          // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 80                                                               // major color (Saturated Bronze)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Ice Paraelemental

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~rr#eicer~                                                             // Ice Paraelemental (aTweaks)
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "50529024"                                                        // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (transparency fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "55"                                                              // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 71                                                               // major color (Frost Blue)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block


// Cryonax

ACTION_FOR_EACH ~file~ IN                                                          // for each of the following files
            ~elemcryo~                                                             // Cryonax
            ~finsol03~                                                             // Cryonax in ToB
BEGIN                                                                              // execute the following
ACTION_IF FILE_EXISTS_IN_GAME ~%file%.cre~ BEGIN                                   // if the file exists
COPY_EXISTING ~%file%.cre~ ~override~
LAUNCH_PATCH_FUNCTION FJ_CRE_VALIDITY
 INT_VAR do_message = 1
END
// =============================================================================== // the actual work starts from here
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "8" END                                               // mark opcode #8 (Colour: Change by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "9" END                                               // mark opcode #9 (Colour Glow Pulse) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "51" END                                              // mark opcode #51 (Colour: Strong/Dark by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "52" END                                              // mark opcode #52 (Colour: Very Bright by RGB) for deletion
  LAUNCH_PATCH_FUNCTION ~DELETE_CRE_EFFECT~                                        // delete the EFF with the designated opcode (remove any existent tint)
  INT_VAR opcode_to_delete = "66" END                                              // mark opcode #66 (transparency fade) for deletion
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "52"                                                                  // effect: #52 (Colour: Very Bright by RGB)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "67108864"                                                        // param1: (RGB colour)
  "parameter2" = "2"                                                               // param2: (location)
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call (add new creature effect built-in function)
  INT_VAR                                                                          // initialize numeric variables
  "opcode" = "66"                                                                  // effect: #66 (transparency fade)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "sectype" = "0"                                                                  // secondary type: none
  "parameter1" = "50"                                                              // param1: (fade amount)
  "parameter2" = "0"                                                               // param2: 0
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize string variables
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends FUNCTION call
PATCH_FOR_EACH ~rr#color~ IN ~9~ ~50~ BEGIN                                        // grant immunity to the color glow/pulse effects (they disrupt aTweaks' re-coloring)
LAUNCH_PATCH_FUNCTION ~ADD_CRE_EFFECT~                                             // Starts FUNCTION call
  INT_VAR                                                                          // initialize variables
  "opcode" = "101"                                                                 // effect: #101 (Protection from Opcode)
  "target" = "1"                                                                   // target: 1 (self)
  "timing" = "9"                                                                   // timing mode: 9 (permanent after death)
  "duration" = "0"                                                                 // duration: 0
  "parameter2" = EVALUATE_BUFFER "%rr#color%"                                      // param2: evaluated opcode
  "sectype" = "0"                                                                  // secondary type: none
  "probability1" = "100"                                                           // probability1: 100%
  STR_VAR                                                                          // initialize strings
  "resource"  = ""                                                                 // resref: none
  "effsource" = ""                                                                 // effsource: none
END                                                                                // ends LAUNCH_PATCH_FUNCTION
END                                                                                // ends PATCH_FOR_EACH
  WRITE_BYTE 0x2E 18                                                               // major color (Dark Blue)
// =============================================================================== // the actual work ends here
BUT_ONLY_IF_IT_CHANGES
END                                                                                // ends ACTION_IF FILE_EXISTS_IN_GAME block
END                                                                                // ends ACTION_FOR_EACH block

